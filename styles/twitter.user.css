/* ==UserStyle==
@name           Twitter
@namespace      https://aldaviva.com/userstyles/
@version        1.0.41
@description    Removed clutter, ads, and unwanted tweets. Render avatars in rounded rectangles instead of circles.
                You can block keywords with https://github.com/Aldaviva/content-blocking-filters
                You may also want to keep the timeline in Latest Tweets mode: https://github.com/Aldaviva/userscripts/raw/master/twitter.user.js
@author         Ben Hutchison <ben@aldaviva.com> (https://aldaviva.com)
@license        MIT
@homepageURL    https://github.com/Aldaviva/userstyles
@supportURL     https://github.com/Aldaviva/userstyles/issues
==/UserStyle== */

@-moz-document domain("twitter.com") {
    /* Hide Get Verified right panel */
    div[data-testid="sidebarColumn"] > div > div > div > div > div > div:nth-child(3),
    /* Hide Listen Live In Spaces right panel */
    div[data-testid="sidebarColumn"] > div > div > div > div > div > div:nth-child(4),
    /* Hide What's Happening right panel */
    div[data-testid="sidebarColumn"] > div > div > div > div > div > div:nth-child(5),
    /* Hide Who To Follow right panel */
    div[data-testid="sidebarColumn"] > div > div > div > div > div > div:nth-child(6),
    /* Hide Explore left navigation link */
    nav a[data-testid="AppTabBar_Explore_Link"],
    /* Hide Twitter Blue left navigation link */
    nav a[aria-label="Twitter Blue"],
    /* Hide Verified Organizations Signup left navigation link */
    nav a[aria-label="Verified Organizations"],
    /* Hide Verified left navigation link */
    nav a[aria-label="Verified"],
    /* Hide Communities left navigation link */
    nav a[aria-label="Communities"],
    /* Hide Notifications left navigation link */
    /*nav a[data-testid="AppTabBar_Notifications_Link"],*/
    /* Hide the Direct Messages floating pane from the bottom-right corner of the page */
    div[data-testid="DMDrawer"],
    /* Hide footer links and copyright */
    nav[aria-label="Footer"],
    /* Hide Compose a Direct Message button in the bottom-right corner of the page */
    aside[aria-label="Compose a Direct Message"]
    /* Hide See What's Happening timeline boxes, like Tokyo 2020 Olympics. Disabled because this also hides inline videos */
    /*div[data-testid="placementTracking"]*/ {
        display: none;
    }
    
    /* Square avatars. Applies to:
     *  - Timeline avatars
     *  - What's Happening self avatar
     *  - Bottom-left account menu avatar
     *  - Profile page big avatar
     *  - Compose Tweet modal dialog self avatar
     *  - Show This Thread
    */
    div[style *= 'background-image: url("https://pbs.twimg.com/profile_images/'] {
        border-radius: 2px;
    }
    div[style *= 'height: calc(100% - '] {
        border-radius: 0;
    }
    
    /* Hide the Replies, Retweets, Likes, and Share buttons underneath each tweet on the home timeline */
    div[aria-label='Timeline: Your Home Timeline'] [data-testid="tweet"] div[role="group"],
    /* Hide the More dropdown from the top-right corner of each tweet on the home timeline */
    div[aria-label='Timeline: Your Home Timeline'] [data-testid="tweet"] div[aria-label="More"] {
        display: none;
    }
    
    /* Hide the Top Tweets button, but don't mess with the layout so it can still be clicked with https://github.com/Aldaviva/userscripts/blob/master/twitter.user.js */
    div[aria-label ^= "Top Tweets"] {
        visibility: hidden;
    }
    
    /* Don't crop images */
    [data-testid="tweet"] a[href *= "/photo/"] div[style="padding-bottom: 50%;"] {
        padding-bottom: 0 !important;
    }
    [data-testid="tweet"] a[href *= "/photo/"] div[style="padding-bottom: 50%;"] + div,
    [data-testid="tweet"] a[href *= "/photo/"] div[style="padding-bottom: 50%;"] + div > div {
        position: static;
    }
    [data-testid="tweet"] a[href *= "/photo/"] div[style="padding-bottom: 50%;"] + div > div img {
        height: auto;
        opacity: 1;
        position: static;
    }
    
    /* Revert tweet composer textboxes' placeholder text */
    /* This seems like the most correct way to replace text in pure CSS, not the visibility or parent element techniques below */
    .public-DraftEditorPlaceholder-inner {
        text-indent: -9999px;
        display: block;
        line-height: 0;
    }
    .public-DraftEditorPlaceholder-inner::after {
        content: "Whatâ€™s happening?";
        text-indent: 0;
        display: block;
        line-height: initial;
    }
    div[aria-label="Timeline: Conversation"] .public-DraftEditorPlaceholder-inner::after {
        content: "Tweet your reply";
    }
    div[data-testid="twc-cc-mask"] + div > div + div .public-DraftEditorPlaceholder-inner::after {
        content: "Add another Tweet";
    }
    
    /* Likes are now once again Favorites */
    a[href $= "/likes"] > span > span {
        text-indent: -9999px;
        display: inline-block;
        line-height: 0;
    }
    a[href $= "/likes"] > span > span::after {
        content: "Favorite(s)";
        text-indent: 0;
        display: block;
        line-height: initial;
    }
    
    nav[aria-label="Profile timelines"] div[role="presentation"]:nth-child(4) a[role="tab"] > div > div > span {
        display: none;
    }
    nav[aria-label="Profile timelines"] div[role="presentation"] a[role="tab"][href$="/likes"] > div > div::before {
        content: "Favorites";
    }
    
    /* Reposts are once again retweets */
    a[href $= "/retweets"] > span > span {
        text-indent: -9999px;
        display: inline-block;
        line-height: 0;
    }
    a[href $= "/retweets"] > span > span::after {
        content: "Retweet(s)";
        text-indent: 0;
        display: block;
        line-height: initial;
    }
    
    a[href $= "/retweets/with_comments"] > span > span {
        text-indent: -9999px;
        display: inline-block;
        line-height: 0;
    }
    a[href $= "/retweets/with_comments"] > span > span::after {
        content: "Quote Tweet(s)";
        text-indent: 0;
        display: block;
        line-height: initial;
    }
    
    /* Posts are now Tweets */
    a[data-testid="SideNav_NewTweet_Button"] div > div > span > span {
        display: none;
    }
    a[data-testid="SideNav_NewTweet_Button"] div > div > span::before {
        content: "Tweet";
    }
    
    div:is([data-testid="tweetButtonInline"], [data-testid="tweetButton"]) div > span > span {
        display: none;
    }
    div:is([data-testid="tweetButtonInline"], [data-testid="tweetButton"]) div > span::before {
        content: "Tweet";
    }
    
    nav[aria-label="Profile timelines"] div[role="presentation"]:nth-child(1) a[role="tab"] > div > div > span {
        display: none;
    }
    nav[aria-label="Profile timelines"] div[role="presentation"]:nth-child(1) a[role="tab"] > div > div::before {
        content: "Tweets";
    }
    
    div[aria-label="Home timeline"] div:has(div[aria-label="Back"]) + div h2 > span {
        text-indent: -9999px;
        display: block;
        line-height: 0;
    }
    div[aria-label="Home timeline"] div:has(div[aria-label="Back"]) + div h2 > span::after {
        content: "Tweet";
        text-indent: 0;
        display: block;
        line-height: initial;
    }
    
}
