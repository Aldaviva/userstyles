/* ==UserStyle==
@name           Bluesky
@namespace      https://aldaviva.com/userstyles/
@version        0.4.0
@description    Make avatar masks into rounded rectangles with small radii, instead of circles. Fix margins in Reply To labels. In dark mode, make background solid black for OLEDs.
@author         Ben Hutchison <ben@aldaviva.com> (https://aldaviva.com)
@license        MIT
@homepageURL    https://github.com/Aldaviva/userstyles
@supportURL     https://github.com/Aldaviva/userstyles/issues
@preprocessor	less
==/UserStyle== */

@-moz-document domain("bsky.app") {
    /* Avatar border radius */
    [data-testid="userAvatarImage"] {
        border-radius: 2px !important;
    }
    [data-testid="profileHeaderAviButton"] {
        border-radius: 4px !important;
    }

    /* Reposted By margin */
    div:has(> svg > path[d="M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]) > div > a {
        margin-left: 0;
    }

    /* Black background */
    .blackBackground() {
        body {
            background-color: black;
        }

        #root > div > div > div > div,
        *[style *= "background-color: rgb(8, 10, 12);"],
        div[style *= "background-color: rgb(1, 1, 1);"] {
            background-color: transparent !important;
        }
    }

    @media (prefers-color-scheme: dark){
        html.colorMode--system {
            /* Ignore the Stylus error, it can't parse LESS mixin invocations, but they do get compiled and rendered correctly in the web page. */
            .blackBackground();
        }
    }

    html.colorMode--dark {
        .blackBackground();
    }
}
